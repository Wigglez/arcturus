<HBProfile creator="Wigglez" version="1.0">
	<Name>[QO-N][MOUNT]_Wigglez_utgarde-pinnacle</Name>
   
	<MinLevel>90</MinLevel>
	<MaxLevel>101</MaxLevel>
   
	<MinDurability>-1</MinDurability>
	<MinFreeBagSlots>-1</MinFreeBagSlots>
	
	<MailGrey>False</MailGrey>
	<MailWhite>False</MailWhite>
	<MailGreen>False</MailGreen>
	<MailBlue>False</MailBlue>
	<MailPurple>False</MailPurple>
   
	<SellGrey>True</SellGrey>
	<SellWhite>True</SellWhite>
	<SellGreen>True</SellGreen>
	<SellBlue>True</SellBlue>
	<SellPurple>False</SellPurple>
   
	<TargetElites>True</TargetElites>
	
	<AvoidMobs>	
		<Mob Name="Summon Enabler Stalker" Entry="53488" />
		
		<Mob Name="Ritual Target" Entry="27327" />
		<Mob Name="Grauf" Entry="26893" />
	</AvoidMobs>
	
	<Blackspots>
	</Blackspots>

	<Mailboxes>
	</Mailboxes>
 
	<Vendors>
	</Vendors>
	
	<ProtectedItems>
		<Item Name="Reins of the Blue Proto-Drake" Entry="44151" />	
	</ProtectedItems>

	<Factions>
	</Factions>
	
	<QuestOrder>
		<ClearVendor />
		<ClearMailbox />

		<CustomBehavior File="UserSettings"
						AdvancedSettingsMode="True"
						FindMountAutomatically="True"
						FindVendorsAutomatically="False"
						GroundMountFarmingMode="False"
						HarvestHerbs="False"
						HarvestMinerals="False"
						KillBetweenHotspots="True"
						LogoutForInactivity="False"
						LogoutInactivityUseForceQuit="False"
						LootChests="False"
						LootMobs="False"
						LootRadius="1"
						MountDistance="75"
						MountName=""
						NinjaSkin="False"
						ProfileDebuggingMode="False"
						PullDistance="25"
						RessAtSpiritHealers="False"
						SkinMobs="False"
						UseFlightPaths="True"
						UseMount="True" 
						UseRandomMount="False" />
							
		
		<!-- If we are inside Utgarde Pinnacle -->
		<If Condition="Me.MapId == 575">
			<CustomBehavior File="Message" 
							Text="Utgarde Pinnacle detected. Running out."
							LogColor="Cyan" />
							
			<RunTo X="580.698" Y="-327.796" Z="110.141" />
			
			<!-- Go through the portal -->
			<CustomBehavior File="Misc\InInstance" X="591.1389" Y="-328.2062" Z="110.1435" />
			
			<!-- Make sure we run to the right spot outside the portal -->
			<RunTo X="1242.55" Y="-4857.47" Z="217.783" />
		</If> <!-- Utgarde Pinnacle -->
	
		<!-- If we are not in the box, load the movement profile -->
		<If Condition="Me.X &lt; 1192 || Me.X &gt; 1292 || Me.Y &lt; -4907 || Me.Y &gt; -4807" >
			<CustomBehavior File="Message" 
							Text="Distance from portal is not within our proximity, initializing movement to get there."
							LogColor="Cyan" />	
							
			<CustomBehavior File="LoadProfile" 
							ProfileName="Movement\[QO-N-M][MOUNT]_Wigglez_utgarde-pinnacle" />
		</If> <!-- Not in box -->
		
		<!-- If we are in the box -->
		<If Condition="Me.X &gt; 1192 &amp;&amp; Me.X &lt; 1292 &amp;&amp; Me.Y &gt; -4907 &amp;&amp; Me.Y &lt; -4807" >
			<CustomBehavior File="RunMacro" Macro="/script SetDungeonDifficultyID(2);" />
		
			<CustomBehavior File="Message" 
							Text="Portal detected nearby."
							LogColor="Cyan" />	
				
			<!-- If we didn't enter the instance, wait 20 seconds then attempt to enter again -->
			<While Condition="Me.MapId != 575">
				<!-- Make sure we run to the right spot outside the portal -->
				<RunTo X="1242.55" Y="-4857.47" Z="217.783" />

				<!-- Run back in the portal -->
				<CustomBehavior File="Misc\InInstance" X="1232.233" Y="-4860.778" Z="218.2891" />
								
				<CustomBehavior File="Message" 
								Text="Waiting for the dungeon to load." 
								LogColor="Cyan" />
							
				<CustomBehavior File="WaitTimer" 
								WaitTime="20000"
								VariantTime="20000" />
								
				<!-- If we still aren't in, we're locked out -->
				<If Condition="Me.MapId != 575">
					<CustomBehavior File="Message" 
									Text="We are locked out. Waiting and trying again." 
									LogColor="Cyan" />
				</If> <!-- Locked -->
			</While> <!-- While we aren't in the instance -->
		</If> <!-- In box -->
		
		<!-- If we are inside and have checked our reset -->
		<If Condition="Me.MapId == 575">
			<!-- Entrance -->
			<RunTo X="580.698" Y="-327.796" Z="110.141" />
			
			<CustomBehavior File="Message" 
							Text="Utgarde Pinnacle initialized."  
							LogColor="Cyan" />
							
			<!-- Hallway connector #1 -->
			<RunTo X="480.9888" Y="-281.8062" Z="104.7163" />
			
			<!-- Hallway connector #2 -->
			<RunTo X="314.0568" Y="-273.8771" Z="104.7125" />
							
			<!-- Get to Skadi the Ruthless -->
			<RunTo X="310.3054" Y="-481.1674" Z="104.7385" />
			
			<!-- Make sure we set Grauf as our focus target -->
			<CustomBehavior File="RunMacro" Macro="/cleartarget \n/target Grauf \n/focus \n/cleartarget" />
			
			<!-- Make it to the end of the hall -->
			<CustomBehavior File="NoCombatMoveTo" X="481.0895" Y="-512.5789" Z="104.7232" />
			
			<!-- While Grauf exists (flight mode), keep looping -->
			<While Condition="Me.FocusedUnit != null">
				<CustomBehavior File="Message" 
								Text="We are in the focused unit loop."  
								LogColor="Cyan" />
			
				<!-- If I don't have a Harpoon -->
				<If Condition="!HasItem(37372) &amp;&amp; Me.FocusedUnit != null" >
					<CustomBehavior File="Message" 
									Text="I don't have a harpoon."  
									LogColor="Cyan" />
				
					<CustomBehavior File="Message" 
									Text="Combat is enabled."  
									LogColor="Red" />
					
					<!-- Enable combat -->
					<EnableBehavior Name="Combat" />
				
					<!-- Move to our starting spot -->
					<CustomBehavior File="NoCombatMoveTo" X="481.0895" Y="-512.5789" Z="104.7232" />
					
					<!-- Go pick up 3 Harpoons -->
					<CustomBehavior File="InteractWith" 
									MobId="192539" 
									WaitForNpcs="false" 
									ObjectType="GameObject" 
									Range="20"
									NumOfTimes="3"
									IgnoreCombat="true"
									X="481.0895" Y="-512.5789" Z="104.7232" />
				</If> <!-- Don't have Harpoon -->
				
				<!-- If I do have a Harpoon -->					
				<If Condition="HasItem(37372) &amp;&amp; Me.FocusedUnit != null" >
					<CustomBehavior File="Message" 
									Text="I have a harpoon."  
									LogColor="Cyan" />
				
					<CustomBehavior File="Message" 
									Text="Combat is disabled."  
									LogColor="Red" />
				
					<!-- Disable combat -->
					<DisableBehavior Name="Combat" />
				
					<CustomBehavior File="Message" 
									Text="Moving to harpoon launchers."  
									LogColor="Cyan" />
									
					<CustomBehavior File="NoCombatMoveTo" X="486.0311" Y="-516.0083" Z="104.7234" />
					
					<!-- If Grauf is in his correct area -->
					<If Condition="Me.FocusedUnit.Location.Distance(new WoWPoint(520, -541, 119)) &lt;= 18" >
						<CustomBehavior File="Message" 
										Text="Grauf is in harpoon range."  
										LogColor="Cyan" />
					
						<!-- Fire a harpoon at him -->
						<CustomBehavior File="InteractWith" 
										MobId1="192175"
										MobId2="192176" 
										MobId3="192177" 
										Range="4.75" 
										IgnoreCombat="true"
										X="486.0311" Y="-516.0083" Z="104.7234" />
					</If> <!-- Grauf is in range -->
				</If> <!-- Have Harpoon -->
			</While> <!-- In combat -->
			
			<CustomBehavior File="Message" 
							Text="We are out of the focused unit loop."  
							LogColor="Cyan" />
							
			<CustomBehavior File="Message" 
							Text="Combat is enabled."  
							LogColor="Lime" />
			
			<!-- Enable combat -->
			<EnableBehavior Name="Combat" />
			
			<!-- Forces kill of Skadi the Ruthless -->
			<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
							EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="26693"
							EventX="481.0895" EventY="-512.5789" EventZ="104.7232"
							MoveOutOfGroundEffectAuraId1="111111"
							MoveAwayFromMobCastingSpellId1="111111"
							MoveAwayFromMobWithAuraId1="111111">
				<Safespots>
					<Hotspot X="481.0895" Y="-512.5789" Z="104.7232" />
				</Safespots>
			</CustomBehavior>
			
			<CustomBehavior File="InteractWith" 
							InteractByLooting="true" 
							MobId="26693" 
							NumOfTimes="1" />
			
			<!-- We are done, leave instance -->
			<CustomBehavior File="Message" 
							Text="Utgarde Pinnacle cleared. Exiting dungeon."
							LogColor="Cyan" />
					
			<!-- Get to Skadi the Ruthless -->
			<RunTo X="310.3054" Y="-481.1674" Z="104.7385" />
					
			<!-- Hallway connector #2 -->
			<RunTo X="314.0568" Y="-273.8771" Z="104.7125" />		
					
			<!-- Hallway connector #1 -->
			<RunTo X="480.9888" Y="-281.8062" Z="104.7163" />
			
			<!-- Get to the entrance -->
			<RunTo X="580.698" Y="-327.796" Z="110.141" />
					
			<!-- Go through the portal -->
			<CustomBehavior File="Misc\InInstance" X="591.1389" Y="-328.2062" Z="110.1435" />
			
			<!-- Make sure we run to the right spot outside the portal -->
			<RunTo X="1242.55" Y="-4857.47" Z="217.783" />
		</If> <!-- Utgarde Pinnacle -->
	</QuestOrder>
</HBProfile>

