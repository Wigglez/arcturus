<HBProfile creator="Wigglez" version="1.0">
	<Name>[QO-N][MOUNT]_Wigglez_karazhan</Name>
   
	<MinLevel>80</MinLevel>
	<MaxLevel>101</MaxLevel>
   
	<MinDurability>-1</MinDurability>
	<MinFreeBagSlots>-1</MinFreeBagSlots>
	
	<MailGrey>False</MailGrey>
	<MailWhite>False</MailWhite>
	<MailGreen>False</MailGreen>
	<MailBlue>False</MailBlue>
	<MailPurple>False</MailPurple>
   
	<SellGrey>True</SellGrey>
	<SellWhite>True</SellWhite>
	<SellGreen>True</SellGreen>
	<SellBlue>True</SellBlue>
	<SellPurple>False</SellPurple>
   
	<TargetElites>True</TargetElites>
	
	<AvoidMobs>	
		<Mob Name="Summon Enabler Stalker" Entry="53488" />
	</AvoidMobs>
	
	<Blackspots>
	</Blackspots>

	<Mailboxes>
	</Mailboxes>
 
	<Vendors>
	</Vendors>
	
	<ProtectedItems>
		<Item Name="Fiery Warhorse's Reins" Entry="30480" />	
	</ProtectedItems>

	<Factions>
	</Factions>
	
	<QuestOrder>
		<ClearVendor />
		<ClearMailbox />

		<CustomBehavior File="UserSettings"
						AdvancedSettingsMode="True"
						FindMountAutomatically="True"
						FindVendorsAutomatically="False"
						GroundMountFarmingMode="False"
						HarvestHerbs="False"
						HarvestMinerals="False"
						KillBetweenHotspots="True"
						LogoutForInactivity="False"
						LogoutInactivityUseForceQuit="False"
						LootChests="False"
						LootMobs="False"
						LootRadius="1"
						MountDistance="75"
						MountName=""
						NinjaSkin="False"
						ProfileDebuggingMode="False"
						PullDistance="25"
						RessAtSpiritHealers="False"
						SkinMobs="False"
						UseFlightPaths="True"
						UseMount="True" 
						UseRandomMount="False" />
							
		
		<!-- If we are inside Karazhan -->
		<If Condition="Me.MapId == 532">
			<CustomBehavior File="Message" 
							Text="Karazhan detected. Running out."
							LogColor="Cyan" />
							
			<RunTo X="-11102" Y="-1998.2" Z="49.8921" />

			<!-- Go through the portal -->
			<CustomBehavior File="Misc\InInstance" X="-11110.64" Y="-2004.849" Z="49.8921" />
			
			<!-- Make sure we run to the right spot outside the portal -->
			<RunTo X="-11113.5" Y="-2006.63" Z="49.3307" />
		</If> <!-- Karazhan -->
	
		<!-- If we are not in the box, load the movement profile -->
		<If Condition="Me.X &lt; -11163 || Me.X &gt; -11063 || Me.Y &lt; -2056 || Me.Y &gt; -1956" >
			<CustomBehavior File="Message" 
							Text="Distance from portal is not within our proximity, initializing movement to get there."
							LogColor="Cyan" />	
							
			<CustomBehavior File="LoadProfile" 
							ProfileName="Movement\[QO-N-M][MOUNT]_Wigglez_karazhan" />
		</If> <!-- Not in box -->
		
		<!-- If we are in the box -->
		<If Condition="Me.X &gt; -11163 &amp;&amp; Me.X &lt; -11063 &amp;&amp; Me.Y &gt; -2056 &amp;&amp; Me.Y &lt; -1956" >
			<CustomBehavior File="Message" 
							Text="Portal detected nearby."
							LogColor="Cyan" />	
				
			<!-- If we didn't enter the instance, wait 20 seconds then attempt to enter again -->
			<While Condition="Me.MapId != 532">
				<!-- Make sure we run to the right spot outside the portal -->
				<RunTo X="-11113.5" Y="-2006.63" Z="49.3307" />
				
				<!-- Interact with Karazhan Gathouse Portcullis -->
				<CustomBehavior File="InteractWith" 
								MobId="184164"
								ObjectType="Gameobject"
								Range="4.75" 
								NumOfTimes="1"				
								X="-11111.0283" Y="-2004.48254" Z="49.3826981" />
				
				<!-- Run back in the portal -->
				<CustomBehavior File="Misc\InInstance" X="-11109.03" Y="-2003.176" Z="49.3307" />
								
				<CustomBehavior File="Message" 
								Text="Waiting for the dungeon to load." 
								LogColor="Cyan" />
							
				<CustomBehavior File="WaitTimer" 
								WaitTime="20000"
								VariantTime="20000" />
								
				<!-- If we still aren't in, we're locked out -->
				<If Condition="Me.MapId != 532">
					<CustomBehavior File="Message" 
									Text="We are locked out. Waiting and trying again." 
									LogColor="Cyan" />
									
					<!-- Interact with Karazhan Gathouse Portcullis -->
					<CustomBehavior File="InteractWith" 
									MobId="184164"
									ObjectType="Gameobject"
									Range="4.75" 
									NumOfTimes="1"				
									X="-11111.0283" Y="-2004.48254" Z="49.3826981" />				
				</If> <!-- Locked -->
			</While> <!-- While we aren't in the instance -->
		</If> <!-- In box -->
		
		<!-- If we are inside and have checked our reset -->
		<If Condition="Me.MapId == 532">
			<!-- Entrance -->
			<RunTo X="-11102" Y="-1998.2" Z="49.8921" />

			<CustomBehavior File="Message" 
							Text="Karazhan initialized."  
							LogColor="Cyan" />
							
			<!-- Open Gatehouse Door -->
			<CustomBehavior File="InteractWith" 
							MobId="183450"
							ObjectType="Gameobject"
							Range="4.75" 
							NumOfTimes="1"						
							X="-11100.5762" Y="-1992.92786" Z="49.8486061" />
							
			<!-- Clear up to Midnight -->
			<RunTo X="-11089.34" Y="-1927.623" Z="49.88885" />
			<RunTo X="-11107.02" Y="-1939.391" Z="49.88885" />
			<RunTo X="-11133.41" Y="-1962.697" Z="49.8859" />
			<RunTo X="-11156.18" Y="-1953.349" Z="49.89053" />
			<RunTo X="-11144.79" Y="-1934.865" Z="49.89053" />
			<RunTo X="-11165.12" Y="-1935.269" Z="49.89053" />
			<RunTo X="-11149" Y="-1912.412" Z="49.88841" />
			<RunTo X="-11137.83" Y="-1890.792" Z="49.88841" />

			<!-- Target and move to Midnight -->
			<CustomBehavior File="TargetAndMoveToMob" 
							MobId="16151" 
							MoveWithinMaxRangeOfMob="1" 
							WaitForNpcs="false"
							TargetOnlyIfHealthPercentAbove="5" 
							X="-11126.25" Y="-1929.111" Z="49.24639" />
		
			<!-- Attumen the Huntsman off horse = 15550 -->
			<!-- Attumen the Huntsman on horse = 16152 (corpse) -->
		
			<!-- Forces kill of Attumen the Huntsman -->
			<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
							EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="16152"
							EventX="-11126.25" EventY="-1929.111" EventZ="49.24639"
							MoveOutOfGroundEffectAuraId1="111111"
							MoveAwayFromMobCastingSpellId1="111111"
							MoveAwayFromMobWithAuraId1="111111">
				<Safespots>
					<Hotspot X="-11126.25" Y="-1929.111" Z="49.24639" />
				</Safespots>
			</CustomBehavior>
			
			<CustomBehavior File="InteractWith" InteractByLooting="true" MobId="16152" NumOfTimes="1" />
	  
			<!-- We are done, go reset -->
			<CustomBehavior File="Message" 
							Text="Karazhan cleared. Exiting dungeon."
							LogColor="Cyan" />
							
			<!-- Run to Gatehouse Door -->
			<RunTo X="-11095.61" Y="-1993.368" Z="49.88253" />
			
			<!-- Open Gatehouse Door -->
			<CustomBehavior File="InteractWith" 
							MobId="183450"
							ObjectType="Gameobject"
							Range="4.75" 
							NumOfTimes="1"						
							X="-11100.5762" Y="-1992.92786" Z="49.8486061" />
							
			<RunTo X="-11102" Y="-1998.2" Z="49.8921" />

			<!-- Go through the portal -->
			<CustomBehavior File="Misc\InInstance" X="-11110.64" Y="-2004.849" Z="49.8921" />
			
			<!-- Make sure we run to the right spot outside the portal -->
			<RunTo X="-11113.5" Y="-2006.63" Z="49.3307" />				
		</If> <!-- Karazhan -->
	</QuestOrder>
</HBProfile>

