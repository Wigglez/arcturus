<HBProfile creator="Wigglez" version="1.0">
	<Name>[QO-N][MOUNT]_Wigglez_stratholme</Name>
   
	<MinLevel>80</MinLevel>
	<MaxLevel>101</MaxLevel>
   
	<MinDurability>-1</MinDurability>
	<MinFreeBagSlots>-1</MinFreeBagSlots>
	
	<MailGrey>False</MailGrey>
	<MailWhite>False</MailWhite>
	<MailGreen>False</MailGreen>
	<MailBlue>False</MailBlue>
	<MailPurple>False</MailPurple>
   
	<SellGrey>True</SellGrey>
	<SellWhite>True</SellWhite>
	<SellGreen>True</SellGreen>
	<SellBlue>True</SellBlue>
	<SellPurple>False</SellPurple>
   
	<TargetElites>True</TargetElites>
	
	<AvoidMobs>	
		<Mob Name="Summon Enabler Stalker" Entry="53488" />
	</AvoidMobs>
	
	<Blackspots>
	</Blackspots>

	<Mailboxes>
	</Mailboxes>
 
	<Vendors>
	</Vendors>
	
	<ProtectedItems>
		<Item Name="Deathcharger's Reins" Entry="13335" />	
	</ProtectedItems>

	<Factions>
	</Factions>
	
	<QuestOrder>
		<ClearVendor />
		<ClearMailbox />

		<CustomBehavior File="UserSettings"
						AdvancedSettingsMode="True"
						FindMountAutomatically="True"
						FindVendorsAutomatically="False"
						GroundMountFarmingMode="False"
						HarvestHerbs="False"
						HarvestMinerals="False"
						KillBetweenHotspots="True"
						LogoutForInactivity="False"
						LogoutInactivityUseForceQuit="False"
						LootChests="False"
						LootMobs="False"
						LootRadius="1"
						MountDistance="75"
						MountName=""
						NinjaSkin="False"
						ProfileDebuggingMode="False"
						PullDistance="25"
						RessAtSpiritHealers="False"
						SkinMobs="False"
						UseFlightPaths="True"
						UseMount="True" 
						UseRandomMount="False" />
							
		<!-- Infinite loop -->
		<While Condition="true" >
			<!-- If we are inside Stratholme -->
			<If Condition="Me.MapId == 329">
				<CustomBehavior File="Message" 
								Text="Stratholme detected. Running out."
								LogColor="Cyan" />
								
				<RunTo X="3590.87" Y="-3643.22" Z="138.4906" />
				
				<!-- Go through the portal -->
				<CustomBehavior File="Misc\InInstance" X="3588.953" Y="-3639.53" Z="138.4773" />
				
				<!-- Make sure we run to the right spot outside the portal -->
				<RunTo X="3233.06" Y="-4048.3" Z="108.4417" />
			</If> <!-- Stratholme -->
		
			<!-- If we are not in the box, load the movement profile -->
			<If Condition="Me.X &lt; 3200 || Me.X &gt; 3300 || Me.Y &lt; -4100 || Me.Y &gt; -4000" >
				<CustomBehavior File="Message" 
								Text="Distance from portal is not within our proximity, initializing movement to get there."
								LogColor="Cyan" />	
								
				<CustomBehavior File="LoadProfile" 
								ProfileName="Movement\[QO-N-M][MOUNT]_Wigglez_stratholme" />
			</If> <!-- Not in box -->
			
			<!-- If we are in the box -->
			<If Condition="Me.X &gt; 3200 &amp;&amp; Me.X &lt; 3300 &amp;&amp; Me.Y &gt; -4100 &amp;&amp; Me.Y &lt; -4000" >
				<!-- Do repair check and bag check -->
				<If Condition="(Me.LowestDurabilityPercent &lt; 0.3) || (Me.FreeBagSlots &lt; 25)" >
					<CustomBehavior File="Message" 
									Text="Vendoring or repairing is necessary. Switching to movement." 
									LogColor="Cyan" />
									
					<CustomBehavior File="LoadProfile" 
									ProfileName="Movement\[QO-N-M][MOUNT]_Wigglez_stratholme" />
				</If> <!-- Repair/sell -->
				
				<CustomBehavior File="RunMacro" Macro="/script SetDungeonDifficultyID(1);" />
			
				<CustomBehavior File="Message" 
								Text="Portal detected nearby."
								LogColor="Cyan" />	
					
				<!-- If we didn't enter the instance, wait 20 seconds then attempt to enter again -->
				<While Condition="Me.MapId != 329">
					<!-- Make sure we run to the right spot outside the portal -->
					<RunTo X="3233.06" Y="-4048.3" Z="108.4417" />

					<!-- Run back in the portal -->
					<CustomBehavior File="Misc\InInstance" X="3236.011" Y="-4056.648" Z="108.467" />
									
					<CustomBehavior File="Message" 
									Text="Waiting for the dungeon to load." 
									LogColor="Cyan" />
								
					<CustomBehavior File="WaitTimer" 
									WaitTime="20000"
									VariantTime="20000" />
									
					<!-- If we still aren't in, we're locked out -->
					<If Condition="Me.MapId != 329">
						<CustomBehavior File="Message" 
										Text="We are locked out. Waiting and trying again." 
										LogColor="Cyan" />
					</If> <!-- Locked -->
				</While> <!-- While we aren't in the instance -->
			</If> <!-- In box -->
			
			<!-- If we are inside and have checked our reset -->
			<If Condition="Me.MapId == 329">
				<!-- Entrance -->
				<RunTo X="3590.87" Y="-3643.22" Z="138.4906" />
				
				<CustomBehavior File="Misc\InstanceTimer" Timer="Start" /> 
				
				<CustomBehavior File="Message" 
								Text="Stratholme initialized."  
								LogColor="Cyan" />
				
				<!-- Open Service Entrance Gate -->
				<CustomBehavior File="InteractWith" 
								MobId="175368"
								ObjectType="Gameobject"
								Range="4.75" 
								NumOfTimes="1"
								X="3624.90845" Y="-3642.1626" Z="138.445114" />
								
				<!-- Get to the first Gauntlet Gate -->
				<RunTo X="3724.146" Y="-3599.966" Z="142.3389" />
				
				<!-- Open first Gauntlet Gate -->
				<CustomBehavior File="InteractWith" 
								MobId="175357"
								ObjectType="Gameobject"
								Range="4.75" 
								NumOfTimes="1"
								X="3727.29126" Y="-3599.08252" Z="142.219528" />
				
				<!-- Get to the second Gauntlet Gate -->
				<RunTo X="3781.305" Y="-3586.75" Z="143.4952" />
				
				<!-- Open second Gauntlet Gate -->
				<CustomBehavior File="InteractWith" 
								MobId="175356"
								ObjectType="Gameobject"
								Range="4.75" 
								NumOfTimes="1"		
								X="3782.58057" Y="-3590.479" Z="143.987152" />
								
				<!-- Get to Nerub'enkan -->
				<RunTo X="3859.339" Y="-3553.635" Z="138.6574" />
				
				<!-- Forces kill of Nerub'enkan -->
				<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
								EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="10437"
								EventX="3855.317" EventY="-3532.143" EventZ="144.2098"
								MoveOutOfGroundEffectAuraId1="111111"
								MoveAwayFromMobCastingSpellId1="111111"
								MoveAwayFromMobWithAuraId1="111111">
					<Safespots>
						<Hotspot X="3855.317" Y="-3532.143" Z="144.2098" />
					</Safespots>
				</CustomBehavior>
				
				<!-- Kill Nerub'enkan's ziggurat -->
				<RunTo X="3847.4" Y="-3495.658" Z="141.2103" />
				<RunTo X="3840.184" Y="-3500.794" Z="144.2094" />
				<RunTo X="3831.527" Y="-3502.956" Z="141.2106" />
				
				<!-- Get to Baroness Anastari -->
				<RunTo X="3860.197" Y="-3694.556" Z="141.7635" />
				
				<!-- Forces kill of Baroness Anastari -->
				<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
								EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="10436"
								EventX="3855.335" EventY="-3715.75" EventZ="148.092"
								MoveOutOfGroundEffectAuraId1="111111"
								MoveAwayFromMobCastingSpellId1="111111"
								MoveAwayFromMobWithAuraId1="111111">
					<Safespots>
						<Hotspot X="3855.335" Y="-3715.75" Z="148.092" />
					</Safespots>
				</CustomBehavior>
				
				<!-- Kill Baroness Anastari's ziggurat -->
				<RunTo X="3839.372" Y="-3748.054" Z="145.0911" />
				<RunTo X="3847.953" Y="-3747.629" Z="148.0899" />
				<RunTo X="3855.875" Y="-3750.441" Z="145.0915" />
				
				<!-- Get to Maleki the Pallid -->
				<RunTo X="4013.089" Y="-3638.08" Z="129.8706" />
				
				<!-- Forces kill of Maleki the Pallid -->
				<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
								EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="10438"
								EventX="4033.045" EventY="-3645.602" EventZ="135.6548"
								MoveOutOfGroundEffectAuraId1="111111"
								MoveAwayFromMobCastingSpellId1="111111"
								MoveAwayFromMobWithAuraId1="111111">
					<Safespots>
						<Hotspot X="4033.045" Y="-3645.602" Z="135.6548" />
					</Safespots>
				</CustomBehavior>
				
				<!-- Kill Maleki the Pallid's ziggurat -->
				<RunTo X="4052.134" Y="-3673.243" Z="132.6551" />
				<RunTo X="4058.352" Y="-3667.021" Z="135.453" />
				<RunTo X="4063.546" Y="-3659.911" Z="132.6551" />

				<!-- Get to abominations -->
				<RunTo X="4038.797" Y="-3487.308" Z="121.7373" />
				
				<!-- Start annihilating abominations -->
				<CustomBehavior File="InteractWith"  
								MobId1="10416" 
								MobId2="10417" 
								ObjectType="Npc" 
								NumOfTimes="9" 
								CollectionDistance="300"
								MobState="Alive"
								WaitForNpcs="False"
								X="4012.281" Y="-3432.146" Z="119.8165" />
				
				<!-- Forces kill of Ramstein the Gorger -->
				<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
								EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="10439"
								EventX="4032.896" EventY="-3409.701" EventZ="115.6923"
								MoveOutOfGroundEffectAuraId1="111111"
								MoveAwayFromMobCastingSpellId1="111111"
								MoveAwayFromMobWithAuraId1="111111">
					<Safespots>
						<Hotspot X="4032.896" Y="-3409.701" Z="115.6923" />
					</Safespots>
				</CustomBehavior>
				
				<!-- Sit in Ramstein's spot -->
				<RunTo X="4032.896" Y="-3409.701" Z="115.6923" />
				
				<CustomBehavior File="WaitTimer" 
								WaitTime="30000" />
								
				<!-- Sit in Ramstein's spot again -->
				<RunTo X="4032.896" Y="-3409.701" Z="115.6923" />		
				
				<CustomBehavior File="WaitTimer" 
								WaitTime="30000" />
							
				<!-- Forces kill of Lord Aurius Rivendare -->
				<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
								EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="45412"
								EventX="4035.828" EventY="-3336.308" EventZ="115.0599"
								MoveOutOfGroundEffectAuraId1="111111"
								MoveAwayFromMobCastingSpellId1="111111"
								MoveAwayFromMobWithAuraId1="111111">
					<Safespots>
						<Hotspot X="4035.828" Y="-3336.308" Z="115.0599" />
					</Safespots>
				</CustomBehavior>
				
				<CustomBehavior File="InteractWith" 
								InteractByLooting="true" 
								MobId="45412" 
								NumOfTimes="1" />
          
				<!-- We are done, go reset -->
				<CustomBehavior File="Message" 
								Text="Stratholme detected. Running out to reset."
								LogColor="Cyan" />
						
				<!-- Provide a better workaround than going through the maggot cage -->
				<RunTo X="3980.195" Y="-3632.67" Z="130.331" />
				<RunTo X="3859.742" Y="-3685.103" Z="142.5859" />
				<RunTo X="3775.178" Y="-3579.06" Z="142.2685" />
				<RunTo X="3764.503" Y="-3586.495" Z="142.3703" />
						
				<!-- Get to the entrance gate -->
				<RunTo X="3628.088" Y="-3640.253" Z="138.5343" />
				
				<!-- Open Service Entrance Gate -->
				<CustomBehavior File="InteractWith" 
								MobId="175368"
								ObjectType="Gameobject"
								Range="4.75" 
								NumOfTimes="1"
								X="3624.90845" Y="-3642.1626" Z="138.445114" />
								
				<RunTo X="3590.87" Y="-3643.22" Z="138.4906" />
				
				<CustomBehavior File="Misc\InstanceTimer" Timer="Check" />  
				
				<!-- Go through the portal -->
				<CustomBehavior File="Misc\InInstance" X="3588.953" Y="-3639.53" Z="138.4773" />
				
				<!-- Make sure we run to the right spot outside the portal -->
				<RunTo X="3233.06" Y="-4048.3" Z="108.4417" />
			</If> <!-- Stratholme -->
			
			<!-- If we are in the box -->
			<If Condition="Me.X &gt; 3200 &amp;&amp; Me.X &lt; 3300 &amp;&amp; Me.Y &gt; -4100 &amp;&amp; Me.Y &lt; -4000" >
				<CustomBehavior File="Message" 
								Text="Resetting instance." 
								LogColor="Cyan" />
				
				<CustomBehavior File="RunMacro" Macro="/script ResetInstances()" />
				<CustomBehavior File="RunMacro" Macro="/script SetDungeonDifficultyID(1);" />
				
				<CustomBehavior File="Message" 
								Text="Instance reset." 
								LogColor="Cyan" />
			</If> <!-- In box -->
		</While> <!-- Infinite loop -->
	</QuestOrder>
</HBProfile>

